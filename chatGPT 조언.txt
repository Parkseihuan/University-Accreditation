

말씀해주신 요구사항과 두 편람(3주기·4주기)을 같이 놓고 보면,  
“그냥 md에 쓰고 자동 업데이트” 수준을 넘어서, **3·4주기 연속성을 보이면서도 4주기 양식에 100% 맞는 ‘반자동 보고서 엔진’**을 만드는 쪽이 좋습니다.

아래는 그 관점에서 조금 더 정교하게 다듬은 제안입니다.

---

## 1. 전반 설계 원칙 (3주기 ↔ 4주기 연결 + 4주기 양식 완전 대응)

### 1) 시간축·주기 개념 정리

- **실제 인증평가**는 항상 “최근 3년”만 보지만,
- 내부 자체진단/관리 목적이라면 **2021–2025(이후도 계속)** 흐름을 한 눈에 보는 게 중요합니다.

그래서:

- md에는 **2021–2025 전체 표/그래프 구조**를 두되,
- 그 안에서 “4주기 공식 평가 구간(예: 2023–2025)”을 명시해주는 방식이 좋습니다.
- 예: 표는 2021~2025년까지 컬럼(또는 행) 확장 가능하게 설계,  
  하단에 “※ 4주기 공식 평가기간: 2023–2025년” 표시.

### 2) 3주기(a색) vs 4주기(b색) 표현 규칙

- a색(3주기): `#1f77b4` (파랑)
- b색(4주기): `#ff7f0e` (주황)

일괄 규칙:

```markdown
3주기에서 가져온 정량/정성 내용  
4주기에 새로 채워진 정량/정성 내용
```

- 표의 셀/연도/문단에 모두 이 스타일을 재사용하면,  
  “3주기 어느 부분을 인용했는지”가 문서만 봐도 즉시 구분됩니다.

### 3) “편람 양식(양식 3.x-y)”과 완전 호환되는 md 구조

두 편람 내용을 보면:

- **3주기 3.1**: 전임교원 확보율(양식 3.1-1) 위주
- **4주기 3.1**:  
  - 전임 + 겸임 확보율 (양식 3.1-1, 3.1-2)  
  - 소속별·직제별·유형별 구성 (양식 3.1-3)  
  - 최근 3년간 전임교원 신규임용 (양식 3.1-4)

이런 식으로 4주기는 **양식 수와 정량지표가 확 늘어났습니다.**

따라서 md 파일은:

- 각 평가준거마다 “편람 양식 번호”를 섹션/표 단위로 그대로 반영하고,
- 3주기 자료는 해당되는 양식에 **색만 바꿔 실어주거나, 없으면 ‘3주기 해당 없음’** 처리.

이렇게 하면:

1. **관리·가독성**: “양식 3.4-3”이 편람과 md 모두에서 동일 이름으로 존재 → 소통 쉬움  
2. **자동화**: 스크립트에서 “양식 3.4-3”이라는 식별자를 기준으로 처리 가능

---

## 2. 평가준거별 md 구조 – 4주기 양식 + 3주기 내용 결합

아래는 핵심만 짚겠습니다. (필요하시면 각 md를 실제 코드 수준으로 만들어 드릴 수 있습니다.)

---

### 2.1. 3.1 교원 확보 및 구성

#### (1) 제안 md 골격

```markdown
---
criterion: "3.1"
title: "교원 확보 및 구성"
---

# 3.1 교원 확보 및 구성

## 1. 핵심 지표 요약

- 전임교원 및 겸임교원 확보율(최근 5년 추이)
- 교원 소속별·직제별·유형별 구성
- 전임교원 신규 임용 현황

## 2. 정량 지표

### 2-1. 전임교원 확보율 (양식 3.1-1 기반 확장)

> 3주기(2021–2023)는 파란색, 4주기(2023–2025)는 주황색으로 표시  
> 공식 평가 구간: 4주기 기준 최근 3년(예: 2023–2025)


  
    
      공시연도
      전임교원수(A)
      교원 법정정원(B)
      전임교원 확보율(%) C=(A/B)×100
      비고
    
  
  
    
    
    
      2021
      …
      …
      …
      3주기 자료
    
    … 2022 …
    … 2023 …
    

    
    
    
      2023
      …
    
    
      2024
      …
    
    
      2025
      …
    
    
  


※ 내부 관리용으로는 2021~2025 전체 유지, 편람 제출용에는 4기 3개년만 별도 추출 가능

### 2-2. 겸임교원 확보율 (양식 3.1-2)


(여기에 2023~2025 겸임교원 확보율 자동 삽입)


### 2-3. 소속별·직제별·유형별 교원현황 (양식 3.1-3)

- 3주기에는 없던 양식이므로,  
  3주기 부분은 아래처럼 명시:


※ 3주기 편람에는 소속별·직제별·유형별 교원현황 양식이 없었으므로,
해당 항목은 4주기 기준으로 새롭게 작성하였습니다.



(여기에 2026.4.1 기준 교원현황 표 자동 생성)


### 2-4. 최근 3년간 전임교원 신규 임용 현황 (양식 3.1-4)


(2023~2025 신규 임용 현황 표)


## 3. 정성 분석

### 3-1. 3주기 분석 요약


3주기 보고서 중 “전임교원 확보” 관련 서술을 요약/인용


### 3-2. 4주기 분석 (편람 4기 3.1 점검사항 반영)



AI가 2023–2025 정량지표를 바탕으로 작성한 4주기 분석 문단



## 4. 강점 및 개선과제

### 4-1. 강점 (3주기 기반)


3주기 강점 서술 인용


### 4-2. 4주기 기준의 보완·개선 계획



4주기 편람의 "주요 점검사항"을 하나씩 짚으며,
지표와 연결한 개선 과제 및 실행계획 문단


```

이 구조면:

- **3주기 텍스트 = 사람이 채우고 고정**
- **4주기 정량/정성 = AUTO-GEN 블록 안을 스크립트+AI가 매번 갱신**

---

### 2.2. 3.2 교원 인사 및 업적평가

4주기에서 양식이 명확히 생겼습니다:

- 직급별 교원현황 (3.2-1)
- 교원 직급별 승진현황 (3.2-2)
- 트랙별 재임용현황 (3.2-3)

**md 설계 포인트**

- 3주기에는 정량 양식이 정교하지 않았으므로,
  - 3주기 텍스트는 **“제도 설명·운영현황·강점/개선”** 위주로 파랑으로 넣고,
  - 4주기에서 요구하는 세 양식은 **별도 표 + AUTO-GEN**으로 설계.

예:

```markdown
## 2. 정량 지표 (4주기 신설 양식 중심)

### 2-1. 직급별 교원현황 (양식 3.2-1)


(정년/비정년, 교수·부교수·조교수 인원/비율 표 자동 생성)


### 2-2. 교원의 직급별 승진 현황 (양식 3.2-2)


(연도별 승진대상자·승진자·승진율 표)


### 2-3. 최근 3년간 트랙별 재임용 현황 (양식 3.2-3)


(정년/비정년 트랙별 재임용률 표)

```

정성 섹션은:

- 3주기 서술 인용(파랑) +  
- 4주기 평가 항목(이의신청 절차, 학문특성 반영 여부 등)을 하나하나 짚으면서 AI가 분석·개선 제안 생성(주황)

---

### 2.3. 3.3 교원 처우 및 복지

4주기에서 추가된 요소:

- 트랙별·직급별 보수 현황 (양식 3.3-1)
- 복지제도 운영 실적 (3.3-2)
- 트랙·유형별 복지 프로그램 제공 여부 (3.3-3)

여기서는:

1. **3주기 강사 강의료·보수 수준·복지 서술**을 전부 파랑으로 옮기고
2. 4주기에서 요구하는 **트랙 기반 구조**(정년/비정년 + 유형별)를 새로 잡아줍니다.

AUTO-GEN 영역은:

- 강사 강의료 (3년간 기준값 충족 여부 계산 + 코멘트 문단)
- [3.3-1] 표
- [3.3-2], [3.3-3] 표
- “정년트랙 대비 비정년트랙 최저보수 비율” 등 비교 지표 + 분석 문단

---

### 2.4. 3.4 교원의 연구활동 및 성과  (가장 많은 자동화 포인트)

3주기 3.4는 **지원 중심(연구비·연수·연구년제·교육지원인력)**이었고,  
4주기 3.4는 **성과 중심**으로 크게 확대되었습니다:

- 전임교원 1인당 교내연구비 (양식 3.4-1)
- 연구년제 (양식 3.4-2)
- 연구성과(논문/저역서/교외연구비/공연·전시) + 기준값 대비 실적합 (양식 3.4-3)

**md 설계 아이디어**

1. **지원 vs 성과를 분리 섹션**으로:

```markdown
## 2. 지원 지표(3주기 연속)

### 2-1. 전임교원 1인당 교내연구비 (3기/4기 공통 지표)

(양식 3.4-1 확장형 표 + 3기/4기 색상 구분)

### 2-2. 연구년제 운영 (양식 3.4-2)

(과거 3주기 연도 + 4주기 최근 4개 학기까지 연장)

### 2-3. 교육·연구 지원, 학회참여 지원 등 (정성 + 필요시 표)
```

2. **성과 지표는 완전 자동화 영역으로 설계**

```markdown
## 3. 연구성과 지표 (4주기 신설 비중이 큰 영역)

### 3-1. 전임교원 1인당 등재(후보)지 논문, SCI급 논문, 저역서, 교외연구비 (양식 3.4-3)


- 3년간 평균 실적값 표
- 기준값 대비 실적의 합 계산 결과
- 자연계열/예술계 비율에 따른 평가 기준 적용 결과

```

3. **정성 분석에서 4주기 점검사항을 그대로 체크리스트로 사용**:

- 교내·외 연구비 기준값 충족 여부
- 논문/저역서/공연·전시 실적 기준값 대비 수준
- 연구년제 참여율 권장비율 충족 여부
- 연구윤리 규정/위원회/교육 실적

이 부분은 AI가 **“데이터 + 4기 편람 텍스트(발췌)”**를 함께 읽고,  
각 항목별로 “충족/부분충족/미충족 + 사유 + 개선방향”을 자동 서술하도록 할 수 있습니다.

---

### 2.5. 3.5 직원 확보 및 인사, 2.6 직원 복지 및 업무 역량 개발

두 준거는 3주기와 4주기 구조가 크게 다르지 않지만, 4주기에서:

- 3.5: 직원 구성 현황(정규/무기계약/비정규 + 직급별) [3.5-1], 승진현황 [3.5-2]가 명시
- 3.6: 직원 보수(정규 vs 비정규), 복지제도 실적 [3.6-2], 역량개발 운영 실적 [3.6-3]

따라서:

- **3주기 때의 “직원 1인당 학생수·인사·평가·복지·역량개발 서술” → 파랑으로 그대로 인용**
- 4주기에서는  
  - [3.5-1], [3.5-2], [3.6-1], [3.6-2], [3.6-3] 양식 구조를 가진 표를 두고,  
  - 해당 표 + “정규/비정규 비율, 최저보수, 복지 집행액, 프로그램 운영건수” 등을 AI/스크립트가 데이터에서 뽑아 자동 채우는 쪽으로 설계하면 좋습니다.

---

## 3. 데이터/코드 구조를 좀 더 ‘프로답게’ 고도화

앞 답변에서는 단순 `scripts/update_criteria.py` 예제를 드렸습니다.  
여기에 **“준거별 설정파일 + 지표별 메트릭 JSON”**을 도입하면 훨씬 관리가 편해집니다.

### 3.1. 평가준거별 설정 파일 (config.yml)

예: `criteria/3.1-교원-확보-및-구성/config.yml`

```yaml
criterion: "3.1"
title: "교원 확보 및 구성"
data_sources:
  - id: "fulltime_ratio"
    files:
      - "../../data/3rd-cycle/3.1/fulltime_ratio_2021_2023.xlsx"
      - "../../data/4th-cycle/3.1/fulltime_ratio_2023_2025.xlsx"
    parser: "parse_fulltime_ratio"
    target_block: "3.1-FULLTIME-RATIO-4TH"
  - id: "parttime_ratio"
    files:
      - "../../data/4th-cycle/3.1/parttime_ratio_2023_2025.xlsx"
    parser: "parse_parttime_ratio"
    target_block: "3.1-PARTTIME-RATIO"
  - id: "structure_table"
    files:
      - "../../data/4th-cycle/3.1/faculty_structure_20260401.xlsx"
    parser: "parse_structure_3_1_3"
    target_block: "3.1-STRUCTURE-TABLE"
  - id: "new_hires"
    files:
      - "../../data/4th-cycle/3.1/new_hires_2023_2025.xlsx"
    parser: "parse_new_hires_3_1_4"
    target_block: "3.1-NEW-HIRE"
llm_blocks:
  - id: "analysis"
    target_block: "3.1-ANALYSIS"
    prompt_template: "../../scripts/prompts/3.1_analysis.txt"
  - id: "improvement"
    target_block: "3.1-IMPROVEMENT"
    prompt_template: "../../scripts/prompts/3.1_improvement.txt"
```

장점:

- 새 지표/새 파일이 생겨도 **config.yml만 수정**하면 스크립트는 고정.
- `parser` 이름으로 어떤 파이썬 함수가 어떤 파일을 어떻게 분석할지 명시.

### 3.2. 메트릭 JSON 캐시

각 parser 함수는:

- Excel/PDF → pandas로 처리 →  
- 최종 결과를 `metrics/3.1.json` 같은 곳에 저장:

```json
{
  "fulltime_ratio": {
    "2021": 72.1,
    "2022": 73.3,
    "2023": 73.2,
    "2024": 74.0,
    "2025": 75.1
  },
  "parttime_ratio_weighted": {
    "2023": 3.5,
    "2024": 3.7,
    "2025": 4.0
  }
}
```

이 JSON을 기반으로:

- 표 행 생성
- LLM 프롬프트에 들어갈 숫자/변화율 계산

을 공통으로 처리할 수 있습니다.

---

## 4. AI 반자동화 흐름 – 한 번 더 정리

### 4.1. 데이터 입력

- 담당자가 **엑셀/PDF/CSV**를 해당 준거 폴더(`data/4th-cycle/3.4/…`)에 추가·갱신
- 가능하다면 양식에 맞는 **고정된 엑셀 포맷**(예: 편람의 양식을 그대로 엑셀로 만든 템플릿)을 사용

### 4.2. GitHub Actions 트리거

- `data/4th-cycle/**` 경로에 변경이 있으면 워크플로우 실행

### 4.3. 스크립트 처리 단계

1. 변경된 파일 확인 → 어떤 준거(3.1~3.6)와 연결되는지 확인  
2. 해당 준거의 `config.yml` 로드  
3. 지정된 `parser` 함수로 각 엑셀/PDF → 메트릭 JSON 갱신  
4. 메트릭 JSON을 이용해:
   - 표 블록(AUTO-GEN)용 HTML/markdown 생성  
   - LLM용 프롬프트 채우기 (편람 발췌 텍스트 + 3주기 요약 + 메트릭)  
   - LLM 응답을 색깔 span으로 감싼 뒤, 해당 블록에 삽입
5. 변경된 md 파일을 commit & push

---

## 5. 구현 로드맵 (현실적인 순서)

1. **레포·폴더 구조 확정 및 md 템플릿 기초 작성**
   - 3.1~3.6 각 md skeleton (섹션 구조 + AUTO-GEN 마커만 먼저)
   - 3주기 서술을 옮길 섹션만 먼저 잡기

2. **3주기 보고서 내용 분배**
   - 3주기 문서를 기준으로 3.1~3.6에 해당하는 부분을 나눠서  
     - 각 md의 “3주기 분석/강점” 섹션에 파랑으로 인용

3. **4주기 편람 요약·발췌**
   - 각 준거별로 “주요 점검사항 + 유의사항·관련정책”을 텍스트 파일(예: `scripts/prompts/3.1_analysis.txt`)로 정리  
   - 이 텍스트는 LLM 프롬프트의 “기준 프레임”으로 활용

4. **최소 기능 스크립트 작성 (3.1만 먼저)**
   - 하나의 엑셀(예: 전임교원 확보율)이 들어오면
     - 표 행 업데이트
     - 간단한 수동 분석(LLM 없이도)으로 문단 하나 갱신
   - GitHub Actions까지 연결해 실제 동작 확인

5. **LLM 연동**
   - OpenAI API(or 다른 LLM) 연결 후,  
   - 3.1의 ANALYSIS/IMPROVEMENT 블록을 LLM 출력으로 대체
   - 프롬프트 템플릿 튜닝(길이, 톤, 편람 용어 반영 등)

6. **3.2~3.6으로 확장**
   - 각 준거마다
     - config.yml 작성
     - parser 함수 작성
     - LLM 프롬프트(분석/개선/요약) 템플릿 작성
   - 차례로 자동화 범위를 넓혀감

---

## 6. 다음에 도와드릴 수 있는 부분

1. 원하시면 **3.1 전체 md 템플릿(실제 문서 형태)**과  
   - `config.yml` 예시  
   - `update_criteria.py` 골격 코드를  
   실제로 복붙해서 쓸 수 있는 수준으로 만들어 드릴 수 있습니다.
2. 사용하실 **엑셀 형식(열 이름/예제 값)**을 한 번만 정해 주시면,  
   - 그 포맷에 맞춘 parser 코드도 바로 작성 가능합니다.

지금 단계에서는:

- 어떤 언어/환경(예: Python + OpenAI API 사용 가능 여부),
- 우선 자동화하고 싶은 준거(3.4처럼 성과지표가 많은 곳부터, 또는 3.1부터)

를 알려주시면, 그 기준으로 **실제 코드/파일 구조 샘플**을 바로 만들어 드리겠습니다.